(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[106],{207:(n,e,t)=>{"use strict";t.d(e,{NQ:()=>i,ZC:()=>a});let r={name:"AES-GCM",length:256};async function a(n,e){let t=new TextEncoder,a=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({...r,iv:a},e,t.encode(n));return{iv:Array.from(a),ciphertext:Array.from(new Uint8Array(i))}}async function i(n,e){let{ciphertext:t,iv:a}=n,i=new TextDecoder,o=await crypto.subtle.decrypt({...r,iv:new Uint8Array(a)},e,new Uint8Array(t));return i.decode(o)}},546:(n,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"warnOnce",{enumerable:!0,get:function(){return t}});let t=n=>{}},1393:(n,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o}});let r=t(4232),a=r.useLayoutEffect,i=r.useEffect;function o(n){let{headManager:e,reduceComponentsToState:t}=n;function o(){if(e&&e.mountedInstances){let a=r.Children.toArray(Array.from(e.mountedInstances).filter(Boolean));e.updateHead(t(a,n))}}return a(()=>{var t;return null==e||null==(t=e.mountedInstances)||t.add(n.children),()=>{var t;null==e||null==(t=e.mountedInstances)||t.delete(n.children)}}),a(()=>(e&&(e._pendingUpdate=o),()=>{e&&(e._pendingUpdate=o)})),i(()=>(e&&e._pendingUpdate&&(e._pendingUpdate(),e._pendingUpdate=null),()=>{e&&e._pendingUpdate&&(e._pendingUpdate(),e._pendingUpdate=null)})),null}},1596:(n,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>m});var r=t(7876),a=t(7328),i=t.n(a),o=t(4232),s=t(9099);let l=null,d=null,c=null;async function p(n){d=(l=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]})).createDataChannel("chat"),c=n,d.onmessage=n=>{c&&c(n.data)},await new Promise(n=>{l.onicecandidate=e=>{e.candidate||n()}});let e=await l.createOffer();return await l.setLocalDescription(e),JSON.stringify(l.localDescription)}async function u(n,e){l=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),c=e,l.ondatachannel=n=>{(d=n.channel).onmessage=n=>{c&&c(n.data)}},await l.setRemoteDescription(JSON.parse(n));let t=await l.createAnswer();return await l.setLocalDescription(t),await new Promise(n=>{l.onicecandidate=e=>{e.candidate||n()}}),JSON.stringify(l.localDescription)}function x(n){d&&"open"===d.readyState?d.send(n):console.warn("❌ DataChannel not open")}var f=t(207);async function b(n){let e=new TextEncoder().encode(n);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",e))).map(n=>n.toString(16).padStart(2,"0")).join("")}async function h(n,e){let t=new TextEncoder,r=await window.crypto.subtle.importKey("spki",function(n){let e=atob(n),t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}(atob(e.replace(/-----.*?-----/g,"").replace(/\s+/g,""))),{name:"RSA-OAEP",hash:"SHA-256"},!1,["encrypt"]),a=t.encode(n);return btoa(String.fromCharCode(...new Uint8Array(await window.crypto.subtle.encrypt({name:"RSA-OAEP"},r,a))))}t(6590);let g={};function m(){let n=(0,s.useRouter)(),e=(0,o.useRef)(null),[t,a]=(0,o.useState)({name:"",bio:""});(0,o.useEffect)(()=>{let e=localStorage.getItem("siphrix_profile");e&&a(JSON.parse(e)),localStorage.getItem("siphrix_session")||n.push("/login")},[]);let d=[{name:"Alice",status:"Online",avatar:"https://randomuser.me/api/portraits/women/1.jpg",time:"2 min ago",online:!0},{name:"Bob",status:"Away",avatar:"https://randomuser.me/api/portraits/men/2.jpg",time:"5 min ago",online:!1},{name:"Carol",status:"Busy",avatar:"https://randomuser.me/api/portraits/women/3.jpg",time:"now",online:!0},{name:"David",status:"Offline",avatar:"https://randomuser.me/api/portraits/men/4.jpg",time:"1 hour ago",online:!1}],[c,m]=(0,o.useState)([{text:"Hey, are you there?",sender:"them"},{text:"Yes! I'm working on Siphrix \uD83D\uDD10",sender:"me"}]);(0,o.useEffect)(()=>{var n;null==(n=e.current)||n.scrollIntoView({behavior:"smooth"})},[c]);let[w,y]=(0,o.useState)(""),[v,j]=(0,o.useState)(0),[k,N]=(0,o.useState)(!0),[D,S]=(0,o.useState)("contacts"),[C,F]=(0,o.useState)(!1),[E,_]=(0,o.useState)(""),A=d.filter(n=>n.name.toLowerCase().includes(E.toLowerCase())),z=c.filter(n=>{var e;return null==(e=n.text)?void 0:e.toLowerCase().includes(E.toLowerCase())}),[O,P]=(0,o.useState)(null),[I,U]=(0,o.useState)(null),[M,R]=(0,o.useState)({}),[L,T]=(0,o.useState)(null),[J,B]=(0,o.useState)([]);async function H(n){if(!O)return"[key missing]";try{let e=JSON.parse(n);return await (0,f.NQ)(e,O)}catch(n){return"[decryption error]"}}(0,o.useEffect)(()=>{let e=localStorage.getItem("siphrix_session");if(!e)return void n.push("/login");let t=JSON.parse(e);if(Date.now()>t.expires){localStorage.removeItem("siphrix_session"),n.push("/login");return}let r=localStorage.getItem("webrtc_offer"),a=localStorage.getItem("webrtc_answer");function i(n){try{let e=JSON.parse(n);if("file"===e.type&&e.metadata){let n=new Blob([Uint8Array.from(e.metadata.encrypted.ciphertext)],{type:e.metadata.type}),t=URL.createObjectURL(n);m(n=>[...n,{file:!0,name:e.metadata.name,type:e.metadata.type,url:t,sender:"them"}]);return}}catch(n){}m(e=>[...e,{text:n,sender:"them"}])}!async function(){if(r||a){if(r&&!a){let n=prompt("\uD83D\uDCE5 Paste the answer SDP:");n&&(await l.setRemoteDescription(JSON.parse(n)),localStorage.setItem("webrtc_answer",n),alert("✅ Connection established!"))}else if(!r&&a){let n=prompt("\uD83D\uDCE5 Paste the offer SDP:"),e=await u(n,i);localStorage.setItem("webrtc_answer",e),alert("✅ Answer sent. You are connected!")}}else{let n=await p(i);localStorage.setItem("webrtc_offer",n),alert("\uD83D\uDCE4 Share this offer with your peer:\n\n"+n)}}()},[]);let W=async()=>{if(!w.trim())return;let n=w.trim(),e=d[v].name;if(!g[e]){let n=await b(e),t=await fetch("/userdata/".concat(n,".json")).then(n=>n.json()).catch(()=>null);if(!t||!t.public_key)return void alert("❌ Recipient not found in DHT.");g[e]=t.public_key}let t=await fetch("/api/route?to=".concat(e)).then(n=>n.json()),r=n;for(let n=t.length-1;n>=0;n--){let e=g[t[n]];r=await h(r,e)}let a={type:"onion",route:t.slice(1),payload:r},i=await h(JSON.stringify(a),g[t[0]]);x(JSON.stringify({type:"onion",route:[t[0]],payload:i})),m(e=>[...e,{text:n,sender:"me",status:"sent"}]),y("")};async function K(n){let e=n.target.files[0];if(!e)return;let t=M[d[v].name];if(!t)return alert("No shared key for this contact");let r=await e.arrayBuffer(),a=await (0,f.ZC)(r,t);x(JSON.stringify({type:"file",metadata:{name:e.name,type:e.type,size:e.size,encrypted:a}}));let i=new Blob([r],{type:e.type}),o=URL.createObjectURL(i);m(n=>[...n,{file:!0,name:e.name,type:e.type,url:o,sender:"me"}]),T(null)}function Y(n){let{text:e}=n,[t,a]=(0,o.useState)("\uD83D\uDD10");return(0,o.useEffect)(()=>{H(e).then(a)},[e]),(0,r.jsx)(r.Fragment,{children:t})}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:"Siphrix Chat"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Inter&display=swap",rel:"stylesheet"}),(0,r.jsx)("style",{children:"\n          html, body {\n            margin: 0;\n            padding: 0;\n            background: #0A0C14;\n            font-family: 'Inter', sans-serif;\n            height: 100%;\n            overflow: hidden;\n          }\n\n\n          .layout {\n            display: flex;\n            flex: 1;\n            lex-direction: row;\n            height: calc(100vh - 60px); /* ✅ this subtracts the topbar height */\n            overflow: hidden;\n          }\n\n\n          .sidebar {\n  width: 280px;\n  background: rgba(17, 19, 26, 0.6);\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px);\n  border-right: 1px solid rgba(255,255,255,0.05);\n  display: flex;\n  flex-direction: column;\n  transition: transform 0.3s ease;\n  z-index: 5;\n}\n\n\n          .sidebar.closed {\n            transform: translateX(-100%);\n          }\n\n          .topbar {\n  height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 12px;\n  background: #0A0C14;\n  padding: 0 16px;\n  border-bottom: 1px solid rgba(255,255,255,0.05);\n  position: relative;\n  z-index: 10;\n}\n\n          .topbar h1 {\n            font-size: 18px;\n            color: white;\n          }\n\n          .topbar input {\n            background: rgba(255,255,255,0.05);\n            border: none;\n            border-radius: 8px;\n            padding: 8px;\n            color: white;\n            margin: 0 12px;\n            width: 200px;\n          }\n\n          .contact-list {\n            flex: 1;\n            overflow-y: auto;\n            padding: 10px;\n          }\n\n          .contact {\n            display: flex;\n            align-items: center;\n            gap: 10px;\n            padding: 10px;\n            border-radius: 12px;\n            cursor: pointer;\n            transition: background 0.2s ease;\n          }\n          .contact.selected {\n  background: rgba(0, 229, 255, 0.1);\n  border: 1px solid #00E5FF;\n}\n\n\n          .contact:hover {\n            background: rgba(255,255,255,0.05);\n          }\n\n          .avatar {\n            width: 36px;\n            height: 36px;\n            border-radius: 50%;\n            position: relative;\n          }\n\n          .dot {\n            position: absolute;\n            bottom: 0;\n            right: 0;\n            width: 10px;\n            height: 10px;\n            border-radius: 50%;\n            border: 2px solid #11131a;\n          }\n\n          .main {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            background: #0A0C14;\n            position: relative;\n            min-height: 0;\n            overflow: hidden;\n          }\n\n\n          .chat-header {\n            display: flex;\n            align-items: center;\n            padding: 16px;\n            gap: 12px;\n            background: #11131a;\n            border-bottom: 1px solid rgba(255,255,255,0.05);\n          }\n\n          .chat-avatar {\n            width: 40px;\n            height: 40px;\n            border-radius: 50%;\n            background: #5e9aff;\n          }\n\n          .pinned {\n            background: #1e1f26;\n            padding: 8px 16px;\n            font-size: 13px;\n            color: #ccc;\n            border-bottom: 1px solid rgba(255,255,255,0.05);\n            position: sticky;\n            top: 0;\n            z-index: 2;\n          }\n\n          .messages {\n            flex: 1;\n            min-height: 0;\n            overflow-y: auto;\n            padding: 20px;\n            display: flex;\n            flex-direction: column;\n            gap: 10px;\n          }\n\n\n\n          .bubble {\n  max-width: 60%;\n  padding: 12px 16px;\n  border-radius: 18px;\n  font-size: 14px;\n  line-height: 1.6;\n  animation: fadeIn 0.25s ease;\n  word-break: break-word;\n  white-space: pre-wrap;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);\n  transition: transform 0.2s ease;\n}\n\n.bubble:hover {\n  transform: scale(1.02);\n}\n\n.incoming {\n  background: rgba(255,255,255,0.05);\n  align-self: flex-start;\n  color: #fff;\n  border-radius: 16px 16px 16px 4px;\n}\n\n.outgoing {\n  background: #00E5FF;\n  align-self: flex-end;\n  color: #000;\n  border-radius: 16px 16px 4px 16px;\n}\n\n          .input-bar {\n            display: flex;\n            padding: 16px;\n            background: #11131a;\n            border-top: 1px solid rgba(255,255,255,0.05);\n          }\n\n          .input-bar input {\n  flex: 1;\n  padding: 12px;\n  border-radius: 10px;\n  border: 1px solid rgba(255,255,255,0.1);\n  background: rgba(255,255,255,0.03);\n  color: white;\n  margin: 0 10px;\n}\n\n\n          .input-bar button {\n  background: #00E5FF;\n  color: black;\n  font-weight: bold;\n  padding: 12px 20px;\n  border: none;\n  border-radius: 10px;\n  margin-left: 10px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.input-bar button:hover {\n  background: #00bddd;\n}\n\n\n          .hamburger {\n            font-size: 24px;\n            background: none;\n            color: white;\n            border: none;\n            cursor: pointer;\n          }\n          .icon {\n  background: transparent;\n  color: #ccc;\n  border: none;\n  font-size: 20px;\n  margin-right: 10px;\n  cursor: pointer;\n}\n.icon:hover {\n  color: #00E5FF;\n}\n.bubble:hover {\n  filter: brightness(1.1);\n}\n.glow-blur {\n  position: fixed;\n  width: 500px;\n  height: 500px;\n  background: radial-gradient(circle at center, rgba(0, 229, 255, 0.15), transparent 70%);\n  filter: blur(120px);\n  z-index: 0;\n  pointer-events: none;\n}\n\n.glow-left {\n  top: 20%;\n  left: -100px;\n}\n\n.glow-right {\n  bottom: 10%;\n  right: -100px;\n  background: radial-gradient(circle at center, rgba(112, 0, 255, 0.12), transparent 70%);\n}\n.settings-icon {\n  font-size: 20px;\n  cursor: pointer;\n  background: transparent;\n  border: none;\n  color: #ccc;\n  transition: transform 0.2s ease;\n}\n\n.settings-icon:hover {\n  transform: rotate(90deg);\n  color: #00E5FF;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(8px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.nav-rail {\n  width: 60px;\n  background: rgba(17, 19, 26, 0.6);\n  backdrop-filter: blur(20px);\n  -webkit-backdrop-filter: blur(20px);\n  border-right: 1px solid rgba(255,255,255,0.05);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding-top: 16px;\n  gap: 16px;\n}\n\n.nav-btn {\n  background: transparent;\n  color: #ccc;\n  border: none;\n  font-size: 20px;\n  padding: 10px;\n  border-radius: 10px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.nav-btn:hover {\n  color: #00E5FF;\n}\n\n.nav-btn.active {\n  background: rgba(0, 229, 255, 0.1);\n  border: 1px solid #00E5FF;\n  color: #00E5FF;\n}\n.avatar-wrap {\n  position: relative;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  overflow: hidden;\n  flex-shrink: 0;\n}\n\n.avatar-img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: 50%;\n}\n.topbar-center {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 2px;\n}\n\n.chat-title {\n  font-size: 16px;\n  font-weight: bold;\n  color: #fff;\n}\n\n.chat-badge {\n  background: rgba(0, 229, 255, 0.1);\n  color: #00E5FF;\n  font-size: 11px;\n  padding: 2px 8px;\n  border-radius: 6px;\n  font-weight: 500;\n}\n\n.topbar-actions {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.action-icon {\n  background: rgba(255, 255, 255, 0.05);\n  border: none;\n  color: #ccc;\n  font-size: 16px;\n  padding: 8px;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: background 0.2s ease;\n}\n\n.action-icon:hover {\n  background: rgba(0, 229, 255, 0.2);\n  color: #00E5FF;\n}\n.drawer {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 280px;\n  height: 100%;\n  background: rgba(17, 19, 26, 0.9);\n  backdrop-filter: blur(24px);\n  -webkit-backdrop-filter: blur(24px);\n  color: #fff;\n  padding: 20px;\n  z-index: 999;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.drawer-header {\n  display: flex;\n  justify-content: space-between;\n  font-weight: bold;\n  font-size: 16px;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: #ccc;\n  font-size: 18px;\n  cursor: pointer;\n}\n\n.profile-card {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  gap: 6px;\n}\n\n.profile-pic {\n  width: 72px;\n  height: 72px;\n  border-radius: 50%;\n  border: 3px solid #00E5FF;\n}\n\n.profile-name {\n  font-size: 16px;\n  font-weight: bold;\n}\n\n.profile-status {\n  color: #00FFAA;\n  font-size: 13px;\n}\n\n.profile-bio {\n  font-size: 13px;\n  color: #aaa;\n}\n\n.drawer-section {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  margin-top: 20px;\n}\n\n.drawer-btn {\n  background: rgba(255,255,255,0.05);\n  color: #ccc;\n  border: none;\n  padding: 10px 12px;\n  border-radius: 10px;\n  text-align: left;\n  cursor: pointer;\n  transition: background 0.2s ease;\n}\n\n.drawer-btn:hover {\n  background: rgba(0, 229, 255, 0.15);\n  color: #00E5FF;\n}\n\n.drawer-btn.danger {\n  background: rgba(255,0,0,0.1);\n  color: #f55;\n  font-weight: bold;\n}\n\n.drawer-btn.danger:hover {\n  background: rgba(255,0,0,0.2);\n  color: #fff;\n}\n\n@media (max-width: 768px) {\n  .layout {\n    flex-direction: column;\n  }\n\n  .nav-rail {\n    flex-direction: row;\n    justify-content: space-around;\n    width: 100%;\n    height: 60px;\n    padding: 8px;\n    position: fixed;\n    bottom: 0;\n    z-index: 10;\n    border-top: 1px solid rgba(255,255,255,0.1);\n  }\n\n  .sidebar {\n    display: none;\n  }\n\n  .main {\n    padding-bottom: 60px; /* make room for mobile nav */\n  }\n\n  .input-bar {\n    position: fixed;\n    bottom: 60px;\n    width: 100%;\n    left: 0;\n    border-top: 1px solid rgba(255,255,255,0.05);\n    padding: 12px;\n    background: #11131a;\n    z-index: 10;\n  }\n\n  .topbar {\n    flex-wrap: wrap;\n    gap: 4px;\n  }\n\n  .topbar-center {\n    flex-direction: column;\n    align-items: flex-start;\n    text-align: left;\n  }\n\n  .chat-title {\n    font-size: 15px;\n  }\n\n  .chat-badge {\n    font-size: 10px;\n  }\n\n  .drawer {\n    width: 100%;\n  }\n}\n\n.drawer {\n  position: fixed;\n  inset: 0;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 999;\n  display: flex;\n  justify-content: flex-start;\n  align-items: stretch;\n}\n\n.drawer-sheet {\n  width: 300px;\n  height: 100%;\n  background: rgba(21, 24, 37, 0.95);\n  padding: 32px 24px;\n  display: flex;\n  flex-direction: column;\n}\n\n.drawer-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 24px;\n}\n\n.drawer-title {\n  font-size: 24px;\n  font-weight: 600;\n  color: #fff;\n}\n\n.drawer-close {\n  font-size: 20px;\n  background: rgba(255, 255, 255, 0.05);\n  border: none;\n  border-radius: 6px;\n  color: #fff;\n  padding: 6px 10px;\n  cursor: pointer;\n}\n\n.drawer-close:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.drawer-section {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  margin-top: auto;\n}\n\n.drawer-btn {\n  background: rgba(255, 255, 255, 0.05);\n  color: #ccc;\n  border: none;\n  padding: 10px 14px;\n  border-radius: 10px;\n  text-align: left;\n  font-size: 14px;\n  cursor: pointer;\n  transition: background 0.2s ease;\n}\n\n.drawer-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: #fff;\n}\n\n.drawer-btn.danger {\n  background: rgba(255, 0, 0, 0.15);\n  color: #f55;\n}\n\n.drawer-btn.danger:hover {\n  background: rgba(255, 0, 0, 0.25);\n  color: #fff;\n}\n\n.profile-section {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  padding: 24px;\n  border-radius: 16px;\n  background: rgba(255, 255, 255, 0.03);\n  position: relative;\n}\n\n.avatar-container {\n  display: flex;\n  justify-content: center;\n  width: 100%;\n}\n\n.profile-avatar {\n  width: 120px;\n  height: 120px;\n  border: 3px solid #00E5FF;\n  box-shadow: 0 0 30px rgba(0, 229, 255, 0.2);\n  border-radius: 100%;\n}\n\n.profile-info {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.profile-name {\n  font-size: 24px;\n  font-weight: 600;\n  color: #FFFFFF;\n}\n\n.online-status {\n  font-size: 16px;\n}\n\n.last-seen {\n  font-size: 14px;\n  color: #636879;\n}\n\n.bio-box {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.bio-label {\n  font-size: 14px;\n  color: #636879;\n}\n\n.bio-text {\n  font-size: 14px;\n  color: #FFFFFF;\n}\n\n.search-bar {\n  background: rgba(255, 255, 255, 0.05);\n  border: none;\n  border-radius: 8px;\n  padding: 8px 12px;\n  color: white;\n  margin-left: 12px;\n  font-size: 14px;\n  flex-shrink: 0;\n  width: 180px;\n}\n.search-bar::placeholder {\n  color: #999;\n}\n\n\n        "})]}),(0,r.jsx)("div",{className:"glow-blur glow-left"}),(0,r.jsx)("div",{className:"glow-blur glow-right"}),(0,r.jsxs)("div",{className:"topbar",children:[(0,r.jsx)("button",{className:"hamburger",onClick:()=>F(!0),children:"☰"}),(0,r.jsx)("input",{type:"text",placeholder:"Search...",value:E,onChange:n=>_(n.target.value),style:{background:"rgba(255,255,255,0.05)",border:"none",borderRadius:"8px",padding:"8px",color:"white",marginLeft:"12px",width:"200px"}}),(0,r.jsxs)("div",{className:"topbar-center",children:[(0,r.jsx)("span",{className:"chat-title",children:"Secure Chat"}),(0,r.jsx)("span",{className:"chat-badge",children:"\uD83D\uDD12 End-to-End Encrypted"})]}),(0,r.jsxs)("div",{className:"topbar-actions",children:[(0,r.jsx)("button",{className:"action-icon",children:"\uD83D\uDCF9"}),(0,r.jsx)("button",{className:"action-icon",children:"\uD83D\uDCDE"}),(0,r.jsx)("button",{className:"action-icon",children:"⚠️"})]})]}),(0,r.jsxs)("div",{className:"layout",children:[(0,r.jsxs)("div",{className:"nav-rail",children:[(0,r.jsx)("button",{className:"nav-btn ".concat("contacts"===D?"active":""),onClick:()=>S("contacts"),children:"\uD83D\uDC65"}),(0,r.jsx)("button",{className:"nav-btn ".concat("profile"===D?"active":""),onClick:()=>S("profile"),children:"\uD83D\uDC64"}),(0,r.jsx)("button",{className:"nav-btn ".concat("settings"===D?"active":""),onClick:()=>S("settings"),children:"⚙️"})]}),(0,r.jsx)("div",{className:"sidebar ".concat(k?"":"closed"),children:(0,r.jsx)("div",{className:"contact-list",children:A.map((n,e)=>{let t=d.findIndex(e=>e.name===n.name);return(0,r.jsxs)("div",{className:"contact ".concat(v===t?"selected":""),onClick:()=>j(t),children:[(0,r.jsxs)("div",{className:"avatar-wrap",children:[(0,r.jsx)("img",{src:n.avatar,className:"avatar-img"}),(0,r.jsx)("div",{className:"dot",style:{backgroundColor:n.online?"#00FFAA":"#777"}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:"bold",color:"#fff"},children:n.name}),(0,r.jsx)("div",{style:{fontSize:"12px",color:"#aaa"},children:n.time})]})]},t)})})}),"contacts"===D&&(0,r.jsxs)("div",{className:"main",children:[(0,r.jsxs)("div",{className:"chat-header",children:[(0,r.jsx)("div",{className:"chat-avatar"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:"bold"},children:d[v].name}),(0,r.jsx)("div",{style:{fontSize:"13px",color:"#aaa"},children:d[v].status}),(0,r.jsx)("div",{style:{fontSize:"12px",color:M[d[v].name]?"#00FFAA":"#f55"},children:function(){let n=d[v].name;return M[n]?"\uD83D\uDD10 Secure with ".concat(n):"❌ Not encrypted"}()})]})]}),(0,r.jsx)("div",{className:"pinned",children:"\uD83D\uDCCC This is a pinned message."}),(0,r.jsxs)("div",{className:"messages",children:[(E?z:c).map((n,e)=>{let t="me"===n.sender,a=n.id&&J.includes(n.id);return(0,r.jsxs)("div",{className:"bubble ".concat(t?"outgoing":"incoming"),children:[n.file?n.type.startsWith("image/")?(0,r.jsx)("img",{src:n.url,alt:n.name,style:{maxWidth:"200px",borderRadius:"10px"}}):n.type.startsWith("audio/")?(0,r.jsxs)("audio",{controls:!0,style:{width:"100%"},children:[(0,r.jsx)("source",{src:n.url,type:n.type}),"Your browser does not support audio playback."]}):(0,r.jsxs)("a",{href:n.url,download:n.name,style:{color:"#00E5FF"},children:["\uD83D\uDCC4 ",n.name]}):(0,r.jsx)(Y,{text:n.text}),t&&(0,r.jsx)("span",{style:{fontSize:"12px",marginLeft:"8px",color:a?"#00FFAA":"#888"},children:a?"✅✅":"✅"})]},e)}),(0,r.jsx)("div",{ref:e})]}),(0,r.jsxs)("div",{className:"input-bar",children:[(0,r.jsx)("button",{className:"icon",children:"\uD83D\uDE00"}),(0,r.jsxs)("label",{className:"icon",style:{cursor:"pointer"},children:["\uD83D\uDCCE",(0,r.jsx)("input",{type:"file",style:{display:"none"},onChange:n=>{let e=n.target.files[0];e&&T(e),K(n)}})]}),L&&(0,r.jsxs)("div",{style:{color:"#ccc",fontSize:"13px",marginRight:"10px"},children:["\uD83D\uDCCE ",L.name," – ",(L.size/1024/1024).toFixed(2)," MB"]}),(0,r.jsx)("input",{placeholder:"Type a message...",value:w,onChange:n=>y(n.target.value),onKeyDown:n=>{"Enter"===n.key&&W()}}),(0,r.jsx)("button",{onClick:W,children:"Send"})]})]}),"profile"===D&&(0,r.jsxs)("div",{className:"main",children:[(0,r.jsxs)("div",{className:"chat-header",children:[(0,r.jsx)("div",{className:"chat-avatar"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:"bold"},children:"My Profile"}),(0,r.jsx)("div",{style:{fontSize:"13px",color:"#aaa"},children:"Status: Available"})]})]}),(0,r.jsxs)("div",{style:{padding:"20px",color:"#ccc"},children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Username:"})," ",t.name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Bio:"})," ",t.bio]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," Encrypted & Private \uD83D\uDEE1️"]})]})]}),"settings"===D&&(0,r.jsxs)("div",{className:"main",children:[(0,r.jsxs)("div",{className:"chat-header",children:[(0,r.jsx)("div",{className:"chat-avatar"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{fontWeight:"bold"},children:"Settings"}),(0,r.jsx)("div",{style:{fontSize:"13px",color:"#aaa"},children:"App Preferences"})]})]}),(0,r.jsxs)("div",{style:{padding:"20px",color:"#ccc"},children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Theme:"})," Dark \uD83C\uDF11"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Notifications:"})," Enabled ✅"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Storage:"})," Local Only \uD83D\uDDC2️"]})]})]})]})," ",C&&(0,r.jsx)("div",{className:"drawer",onClick:()=>F(!1),children:(0,r.jsxs)("div",{className:"drawer-sheet",onClick:n=>n.stopPropagation(),children:[(0,r.jsxs)("div",{className:"drawer-header",children:[(0,r.jsx)("span",{className:"drawer-title",children:"Menu"}),(0,r.jsx)("button",{className:"drawer-close",onClick:()=>F(!1),children:"✖"})]}),(0,r.jsxs)("div",{className:"profile-section",children:[(0,r.jsx)("div",{className:"avatar-container",children:(0,r.jsx)("img",{className:"profile-avatar",src:"https://randomuser.me/api/portraits/men/75.jpg"})}),(0,r.jsxs)("div",{className:"profile-info",children:[(0,r.jsx)("div",{className:"profile-name",children:t.name||"Anonymous"}),(0,r.jsx)("div",{className:"online-status",style:{color:"#00E5FF"},children:"\uD83D\uDFE2 Online"}),(0,r.jsx)("div",{className:"last-seen",children:"Last seen: 2 min ago"})]}),(0,r.jsxs)("div",{className:"bio-box",children:[(0,r.jsx)("div",{className:"bio-label",children:"Bio"}),(0,r.jsx)("div",{className:"bio-text",children:t.bio||"No bio set."})]})]}),(0,r.jsxs)("div",{className:"drawer-section",children:[(0,r.jsx)("button",{className:"drawer-btn",children:"✏️ Edit Profile"}),(0,r.jsx)("button",{className:"drawer-btn",children:"\uD83D\uDD11 Change Password"}),(0,r.jsx)("button",{className:"drawer-btn",children:"\uD83D\uDCDC Update Bio"}),(0,r.jsx)("button",{className:"drawer-btn",onClick:()=>{localStorage.removeItem("siphrix_session"),n.push("/login")},children:"\uD83D\uDEAA Logout"}),(0,r.jsx)("button",{className:"drawer-btn danger",onClick:function(){m([]),R({}),P(null),U(null),alert("\uD83E\uDDE8 All messages and keys wiped!")},children:"\uD83E\uDDE8 Panic Delete"})]})]})})]})}},5648:(n,e)=>{"use strict";function t(n){let{ampFirst:e=!1,hybrid:t=!1,hasQuery:r=!1}=void 0===n?{}:n;return e||t&&r}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"isInAmpMode",{enumerable:!0,get:function(){return t}})},6590:(n,e,t)=>{"use strict";t.d(e,{j0:()=>a});let r={name:"ECDH",namedCurve:"P-256"};async function a(n,e){return{publicKey:await crypto.subtle.importKey("jwk",n,r,!0,[]),privateKey:await crypto.subtle.importKey("jwk",e,r,!0,["deriveKey"])}}},7328:(n,e,t)=>{n.exports=t(9836)},7720:(n,e,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return t(1596)}])},9099:(n,e,t)=>{n.exports=t(8253)},9836:(n,e,t)=>{"use strict";var r=t(5364);Object.defineProperty(e,"__esModule",{value:!0}),!function(n,e){for(var t in e)Object.defineProperty(n,t,{enumerable:!0,get:e[t]})}(e,{default:function(){return h},defaultHead:function(){return u}});let a=t(4252),i=t(8365),o=t(7876),s=i._(t(4232)),l=a._(t(1393)),d=t(9896),c=t(6834),p=t(5648);function u(n){void 0===n&&(n=!1);let e=[(0,o.jsx)("meta",{charSet:"utf-8"},"charset")];return n||e.push((0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),e}function x(n,e){return"string"==typeof e||"number"==typeof e?n:e.type===s.default.Fragment?n.concat(s.default.Children.toArray(e.props.children).reduce((n,e)=>"string"==typeof e||"number"==typeof e?n:n.concat(e),[])):n.concat(e)}t(546);let f=["name","httpEquiv","charSet","itemProp"];function b(n,e){let{inAmpMode:t}=e;return n.reduce(x,[]).reverse().concat(u(t).reverse()).filter(function(){let n=new Set,e=new Set,t=new Set,r={};return a=>{let i=!0,o=!1;if(a.key&&"number"!=typeof a.key&&a.key.indexOf("$")>0){o=!0;let e=a.key.slice(a.key.indexOf("$")+1);n.has(e)?i=!1:n.add(e)}switch(a.type){case"title":case"base":e.has(a.type)?i=!1:e.add(a.type);break;case"meta":for(let n=0,e=f.length;n<e;n++){let e=f[n];if(a.props.hasOwnProperty(e))if("charSet"===e)t.has(e)?i=!1:t.add(e);else{let n=a.props[e],t=r[e]||new Set;("name"!==e||!o)&&t.has(n)?i=!1:(t.add(n),r[e]=t)}}}return i}}()).reverse().map((n,e)=>{let a=n.key||e;if(r.env.__NEXT_OPTIMIZE_FONTS&&!t&&"link"===n.type&&n.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(e=>n.props.href.startsWith(e))){let e={...n.props||{}};return e["data-href"]=e.href,e.href=void 0,e["data-optimized-fonts"]=!0,s.default.cloneElement(n,e)}return s.default.cloneElement(n,{key:a})})}let h=function(n){let{children:e}=n,t=(0,s.useContext)(d.AmpStateContext),r=(0,s.useContext)(c.HeadManagerContext);return(0,o.jsx)(l.default,{reduceComponentsToState:b,headManager:r,inAmpMode:(0,p.isInAmpMode)(t),children:e})};("function"==typeof e.default||"object"==typeof e.default&&null!==e.default)&&void 0===e.default.__esModule&&(Object.defineProperty(e.default,"__esModule",{value:!0}),Object.assign(e.default,e),n.exports=e.default)},9896:(n,e,t)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AmpStateContext",{enumerable:!0,get:function(){return r}});let r=t(4252)._(t(4232)).default.createContext({})}},n=>{var e=e=>n(n.s=e);n.O(0,[636,593,792],()=>e(7720)),_N_E=n.O()}]);