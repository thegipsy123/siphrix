(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{207:(e,t,r)=>{"use strict";r.d(t,{NQ:()=>i,ZC:()=>n});let a={name:"AES-GCM",length:256};async function n(e,t){let r=new TextEncoder,n=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({...a,iv:n},t,r.encode(e));return{iv:Array.from(n),ciphertext:Array.from(new Uint8Array(i))}}async function i(e,t){let{ciphertext:r,iv:n}=e,i=new TextDecoder,o=await crypto.subtle.decrypt({...a,iv:new Uint8Array(n)},t,new Uint8Array(r));return i.decode(o)}},9464:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/register",function(){return r(9508)}])},9508:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(7876),n=r(7328),i=r.n(n),o=r(4232),s=r(9099),l=r(6884);function d(){let e=(0,s.useRouter)(),[t,n]=(0,o.useState)(""),[d,v]=(0,o.useState)(""),[A,j]=(0,o.useState)(""),[F,S]=(0,o.useState)(!1),[C,k]=(0,o.useState)(""),[_,E]=(0,o.useState)(!1),R=async a=>{if(a.preventDefault(),k(""),E(!1),d!==A)return void k("❌ Passwords do not match");S(!0);let n="";{let{hashIdentifierWithPepper:e}=await r.e(576).then(r.bind(r,2576));n=await e(t)}try{let{saveAuthData:a}=await r.e(576).then(r.bind(r,2576)),i=crypto.getRandomValues(new Uint8Array(16)),o=await l.Ay.hash({pass:d,salt:i}),s=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]),p=await crypto.subtle.exportKey("jwk",s.publicKey),c=await crypto.subtle.exportKey("jwk",s.privateKey);await a({identifier:n,password_hash:o.encoded,salt:Array.from(i)});let x=crypto.getRandomValues(new Uint8Array(16)),y={identifier:n,password_hash:o.encoded,salt:Array.from(i),pbkdf2_salt:Array.from(x),profile:{name:t,bio:"This is my encrypted profile \uD83D\uDC64"},keys:{ecdh:{public:p,private:c}}},u=new TextEncoder,h=await crypto.subtle.importKey("raw",u.encode(d),{name:"PBKDF2"},!1,["deriveKey"]),g=await crypto.subtle.deriveKey({name:"PBKDF2",salt:x,iterations:1e5,hash:"SHA-256"},h,{name:"AES-GCM",length:256},!1,["encrypt"]),f=crypto.getRandomValues(new Uint8Array(12)),b=new TextEncoder().encode(JSON.stringify(y)),m=await crypto.subtle.encrypt({name:"AES-GCM",iv:f},g,b),w={iv:Array.from(f),data:Array.from(new Uint8Array(m)),pbkdf2_salt:Array.from(x)};await fetch("/api/upload-vault?user=".concat(n),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),E(!0),k("✅ Registration successful!"),setTimeout(()=>e.push("/login"),1e3)}catch(e){k("❌ Failed to write user file"),console.error(e)}finally{S(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:"Register – Siphrix"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("style",{children:"\n          body {\n            margin: 0;\n            background: #0A0C14;\n            font-family: 'Inter', sans-serif;\n          }\n\n          @keyframes slideUp {\n            from { opacity: 0; transform: translateY(20px); }\n            to { opacity: 1; transform: translateY(0); }\n          }\n\n          @media (max-width: 480px) {\n            h1 { font-size: 24px !important; }\n            p  { font-size: 14px !important; }\n          }\n\n          button:hover {\n            box-shadow: 0px 0px 60px rgba(0, 229, 255, 0.2);\n            transform: translateY(-1px);\n          }\n\n        "})]}),(0,a.jsxs)("main",{style:p,children:[(0,a.jsx)("div",{style:c}),(0,a.jsx)("div",{style:x}),(0,a.jsxs)("div",{style:y,children:[(0,a.jsx)("div",{style:u}),(0,a.jsx)("h1",{style:h,children:"Create Account"}),(0,a.jsx)("p",{style:g,children:"Join the encrypted network"}),C&&(0,a.jsx)("div",{style:{marginBottom:"12px",color:_?"#10B981":"#EF4444",fontWeight:"bold"},children:C}),(0,a.jsxs)("form",{style:f,onSubmit:R,children:[(0,a.jsx)("label",{style:b,children:"Username"}),(0,a.jsx)("input",{type:"text",name:"username",style:m,value:t,onChange:e=>n(e.target.value)}),(0,a.jsx)("label",{style:b,children:"Password"}),(0,a.jsx)("input",{type:"password",name:"password",style:m,value:d,onChange:e=>v(e.target.value)}),(0,a.jsx)("label",{style:b,children:"Confirm Password"}),(0,a.jsx)("input",{type:"password",name:"confirm",style:m,value:A,onChange:e=>j(e.target.value)}),(0,a.jsx)("button",{type:"submit",style:w,disabled:F,children:F?"Creating...":"Register"})]})]})]})]})}r(207);let p={height:"100vh",background:"#0A0C14",color:"#fff",fontFamily:"Inter",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",overflow:"hidden"},c={position:"absolute",top:"10%",left:"10%",width:"400px",height:"400px",background:"radial-gradient(circle at 50% 50%, rgba(0, 229, 255, 0.2) 0%, transparent 70%)",filter:"blur(80px)",opacity:.4},x={position:"absolute",bottom:"10%",right:"10%",width:"500px",height:"500px",background:"radial-gradient(circle at 50% 50%, rgba(112, 0, 255, 0.2) 0%, transparent 70%)",filter:"blur(100px)",opacity:.3},y={zIndex:1,maxWidth:"420px",width:"100%",padding:"40px",borderRadius:"24px",background:"linear-gradient(180deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",border:"1px solid rgba(255,255,255,0.05)",boxShadow:"0px 0px 40px rgba(0, 229, 255, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",animation:"slideUp 0.8s ease forwards"},u={width:"64px",height:"64px",background:"rgba(255,255,255,0.03)",borderRadius:"16px",border:"1px solid rgba(255,255,255,0.05)",marginBottom:"24px",boxShadow:"0px 0px 20px rgba(0, 229, 255, 0.1)"},h={fontSize:"28px",color:"#FFFFFF",margin:"0 0 8px"},g={fontSize:"16px",color:"#B4B7C5",lineHeight:"24px",marginBottom:"24px"},f={width:"100%",display:"flex",flexDirection:"column",gap:"12px"},b={textAlign:"left",color:"#B4B7C5",fontSize:"14px"},m={padding:"12px",width:"100%",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.03)",color:"#fff"},w={cursor:"pointer",height:"40px",padding:"0 24px",borderRadius:"20px",background:"linear-gradient(to right, #00E5FF, #7000FF)",color:"#FFFFFF",fontSize:"14px",fontWeight:500,border:"none",boxShadow:"0 0 20px rgba(0, 229, 255, 0.15)",transition:"all 0.3s ease"}}},e=>{var t=t=>e(e.s=t);e.O(0,[199,636,593,792],()=>t(9464)),_N_E=e.O()}]);