(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{630:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var r=n(7876),a=n(7328),i=n.n(a),o=n(4232),s=n(9099),l=n(6884),d=n(6590);function p(){let e=(0,s.useRouter)(),[t,a]=(0,o.useState)(""),[p,v]=(0,o.useState)(""),[j,k]=(0,o.useState)(!1),[F,S]=(0,o.useState)(""),[C,A]=(0,o.useState)(!1),E=async r=>{if(r.preventDefault(),!j){S(""),A(!1),k(!0);try{var a;let{loadAuthDataRemote:r}=await n.e(576).then(n.bind(n,2576)),o=await r(t,p),s="";{let{hashIdentifierWithPepper:e}=await n.e(576).then(n.bind(n,2576));s=await e(t)}let c=await fetch("/userdata/".concat(s,".enc.json"));if(!c.ok)throw Error("❌ Could not find vault");let x=await c.json();function i(e){return Array.isArray(e)?new Uint8Array(e):"string"==typeof e?new Uint8Array(atob(e).split("").map(e=>e.charCodeAt(0))):e instanceof Uint8Array?e:new Uint8Array([])}let u=i(x.pbkdf2_salt),h=i(x.iv),g=i(x.data),y=new TextEncoder,b=await crypto.subtle.importKey("raw",y.encode(p),{name:"PBKDF2"},!1,["deriveKey"]),f=await crypto.subtle.deriveKey({name:"PBKDF2",salt:u,iterations:1e5,hash:"SHA-256"},b,{name:"AES-GCM",length:256},!1,["decrypt"]),w=await crypto.subtle.decrypt({name:"AES-GCM",iv:h},f,g),m=new TextDecoder().decode(w),v=JSON.parse(m);if(localStorage.setItem("siphrix_profile",JSON.stringify(v.profile)),!(null==v||null==(a=v.keys)?void 0:a.ecdh))throw Error("❌ Vault is missing ECDH keys.");let{public:j,private:k}=v.keys.ecdh,F=await (0,d.j0)(j,k);window.siphrixECDH=F;let{identifier:C,password_hash:E,salt:_}=o;if(C!==s)return void S("❌ Invalid username");if((await l.Ay.hash({pass:p,salt:new Uint8Array(_)})).encoded===E){A(!0),S("✅ Login successful!");let n={username:t,timestamp:Date.now(),expires:Date.now()+864e7};localStorage.setItem("siphrix_session",JSON.stringify(n)),setTimeout(()=>e.push("/chat"),1e3)}else S("❌ Invalid password")}catch(e){S("❌ Error reading auth data"),console.error(e)}}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:"Login – Siphrix"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,r.jsx)("style",{children:"\n          body {\n            margin: 0;\n            background: #0A0C14;\n            font-family: 'Inter', sans-serif;\n          }\n\n          @keyframes slideUp {\n            from { opacity: 0; transform: translateY(20px); }\n            to { opacity: 1; transform: translateY(0); }\n          }\n\n          @media (max-width: 480px) {\n            h1 { font-size: 24px !important; }\n            p  { font-size: 14px !important; }\n          }\n\n            button {\n              cursor: pointer;\n              height: 40px;\n              padding: 0 24px;\n              border-radius: 20px;\n              background: linear-gradient(to right, #00E5FF, #7000FF);\n              color: #FFFFFF;\n              font-size: 14px;\n              font-weight: 500;\n              border: none;\n              box-shadow: 0 0 20px rgba(0, 229, 255, 0.15);\n              transition: all 0.3s ease;\n            }\n\n            button:hover {\n              box-shadow: 0px 0px 60px rgba(0, 229, 255, 0.2);\n              transform: translateY(-1px);\n            }\n\n        "})]}),(0,r.jsxs)("main",{style:c,children:[(0,r.jsx)("div",{style:x}),(0,r.jsx)("div",{style:u}),(0,r.jsxs)("div",{style:h,children:[(0,r.jsx)("div",{style:g}),(0,r.jsx)("h1",{style:y,children:"Welcome Back"}),(0,r.jsx)("p",{style:b,children:"Login to your encrypted world"}),F&&(0,r.jsx)("div",{style:{marginBottom:"12px",color:C?"#10B981":"#EF4444",fontWeight:"bold"},children:F}),(0,r.jsxs)("form",{style:f,onSubmit:E,children:[(0,r.jsx)("label",{style:w,children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",style:m,value:t,onChange:e=>a(e.target.value)}),(0,r.jsx)("label",{style:w,children:"Password"}),(0,r.jsx)("input",{type:"password",name:"password",style:m,value:p,onChange:e=>v(e.target.value)}),(0,r.jsx)("button",{type:"submit",disabled:j,children:j?"Logging in...":"Login"})]})]})]})]})}let c={height:"100vh",background:"#0A0C14",color:"#fff",fontFamily:"Inter",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",overflow:"hidden"},x={position:"absolute",top:"10%",left:"10%",width:"400px",height:"400px",background:"radial-gradient(circle at 50% 50%, rgba(0, 229, 255, 0.2) 0%, transparent 70%)",filter:"blur(80px)",opacity:.4},u={position:"absolute",bottom:"10%",right:"10%",width:"500px",height:"500px",background:"radial-gradient(circle at 50% 50%, rgba(112, 0, 255, 0.2) 0%, transparent 70%)",filter:"blur(100px)",opacity:.3},h={zIndex:1,maxWidth:"420px",width:"100%",padding:"40px",borderRadius:"24px",background:"linear-gradient(180deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",border:"1px solid rgba(255,255,255,0.05)",boxShadow:"0px 0px 40px rgba(0, 229, 255, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",animation:"slideUp 0.8s ease forwards"},g={width:"64px",height:"64px",background:"rgba(255,255,255,0.03)",borderRadius:"16px",border:"1px solid rgba(255,255,255,0.05)",marginBottom:"24px",boxShadow:"0px 0px 20px rgba(0, 229, 255, 0.1)"},y={fontSize:"28px",color:"#FFFFFF",margin:"0 0 8px"},b={fontSize:"16px",color:"#B4B7C5",lineHeight:"24px",marginBottom:"24px"},f={width:"100%",display:"flex",flexDirection:"column",gap:"12px"},w={textAlign:"left",color:"#B4B7C5",fontSize:"14px"},m={padding:"12px",width:"100%",borderRadius:"10px",border:"1px solid rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.03)",color:"#fff"}},5794:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(630)}])},6590:(e,t,n)=>{"use strict";n.d(t,{j0:()=>a});let r={name:"ECDH",namedCurve:"P-256"};async function a(e,t){return{publicKey:await crypto.subtle.importKey("jwk",e,r,!0,[]),privateKey:await crypto.subtle.importKey("jwk",t,r,!0,["deriveKey"])}}}},e=>{var t=t=>e(e.s=t);e.O(0,[199,636,593,792],()=>t(5794)),_N_E=e.O()}]);