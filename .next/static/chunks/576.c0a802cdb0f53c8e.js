"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[576],{2576:(e,t,n)=>{n.d(t,{hashIdentifierWithPepper:()=>o,loadAuthDataRemote:()=>w,saveAuthData:()=>s});let a="crypto"in window&&"subtle"in window.crypto,r=a?window.crypto.subtle:null;function i(e){return[...new Uint8Array(e)].map(e=>e.toString(16).padStart(2,"0")).join("")}async function o(e){if(!r)throw Error("crypto.subtle only works in the browser");let t=new TextEncoder,n=await r.importKey("raw",t.encode("SIPHRIX_SUPER_SECRET"),{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return i(await r.sign("HMAC",n,t.encode(e)))}async function s(e){if(a)localStorage.setItem("siphrix_auth",JSON.stringify(e));else{let t=await n.e(765).then(n.t.bind(n,1765,23));await t.writeFile("user_auth.json",JSON.stringify(e,null,2))}}async function w(e,t){if(!r)throw Error("crypto.subtle only works in the browser");let n=new TextEncoder,a=await r.importKey("raw",n.encode("SIPHRIX_SUPER_SECRET"),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),o=i(await r.sign("HMAC",a,n.encode(e))),s=await fetch("/userdata/".concat(o,".enc.json"));if(!s.ok)throw Error("Vault not found");let w=await s.json(),c=new Uint8Array(w.iv),d=new Uint8Array(w.data),l=new Uint8Array(w.pbkdf2_salt),h=await r.importKey("raw",n.encode(t),{name:"PBKDF2"},!1,["deriveKey"]),u=await r.deriveKey({name:"PBKDF2",salt:l,iterations:1e5,hash:"SHA-256"},h,{name:"AES-GCM",length:256},!1,["decrypt"]),y=await r.decrypt({name:"AES-GCM",iv:c},u,d);return JSON.parse(new TextDecoder().decode(y))}}}]);